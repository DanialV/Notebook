myapp=angular.module("sadjad118",["error","root","add_phone","login","enroll","favorite","user_management","logs"]),myapp.config(["$routeProvider",function(e){e.otherwise({templateUrl:"views/404.html"})}]),myapp.controller("body_controller",["$scope","$http","$location",function(e,t,o){e.error={},e.set_permissions=function(t){e.permissions=t},e.set_menu=function(t){e.menu=t.data,e.user_session=t.username,e.set_permissions(t.premissions)},e.toaster=toastr.options={closeButton:!0,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"toast-bottom-right",preventDuplicates:!0,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"2500",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},t({url:"/get_menu",type:"GET"}).then(function(t){e.set_menu(t.data),e.version=t.version},function(e){toastr.error("اشکال داخلی سرور","خطا")}),e.setActive=function(t){e.loginActive="",e.enrollActive="",e.addphoneActive="",e.favoriteActive="",e.usermanagementActive="",e.logsActive="",e[t+"Active"]="active"},e.condtions=null,e.stu_url="http://stu.sadjad.ac.ir",e.sepehr_url="http://sepehr.sadjad.ac.ir",e.pooya_url="http://pooya.sadjad.ac.ir",e.Header="جستجوی شماره تلفن",e.computer_center="http://sadjad.ac.ir/IT%20center.aspx",e.HeaderName=function(t){e.Header=t},e.logout=function(){t({url:"/logout",method:"GET"}).then(function(o){e.set_permissions([]),t({url:"/get_menu",type:"GET"}).then(function(t){e.set_menu(t.data),window.location="/"},function(e){toastr.error("اشکال داخلی سرور","خطا")})},function(e){toastr.error("اشکال داخلی سرور","خطا")})}}]);
_login=angular.module("login",["ngRoute"]),_login.config(["$routeProvider",function(t){t.when("/login",{templateUrl:"views/login.html",controller:["$scope","$http","$timeout","$location",function(t,o,e,n){t.setActive("login"),t.HeaderName("ورود"),t.body="fade-handel",t.header="fade-handel",t.user={},t.onsubmit=function(){o({method:"POST",url:"/login",data:t.user}).then(function(e){1==e.data.status?(t.set_permissions(e.permissions),toastr.success("خوش آمدید.","ثبت"),o({url:"/get_menu",type:"GET"}).then(function(o){t.set_menu(o.data),n.path("/")},function(t){toastr.error("اشکال داخلی سرور","خطا")})):0==e.status&&toastr.error("نام کاربری یا رمز عبور اشتباه است.","خطا")},function(t){toastr.error("اشکال داخلی سرور","خطا")})},t.onforgot=function(){o({url:"/forget_password",type:"post",data:{email:t.forget_email}}).then(function(t){toastr.succes("لینک بازیابی اطلاعات با موفقیت به ایمیل شما ارسال شد.")},function(t){})}}]})}]);
_root=angular.module("root",["ngRoute","angularSpinner","angular-bind-html-compile"]),_root.config(["$routeProvider",function(e){e.when("/",{templateUrl:"views/main_content.html",controller:["$scope","$http","usSpinnerService",function(e,t,n){e.setActive(""),e.HeaderName("جستجوی شماره تلفن"),e.body="fade-handel",e.header="fade-handel",e._data={},e._data.search="",e.query=[],e.edit_form={},e._edit_form={},e.delete_row=!0,n.stop("spinner"),t({url:"/main_content",method:"GET"}).then(function(t){null!=t&&(t.permissions.indexOf("phone_number")!=-1&&(e.phone_number=!0),t.permissions.indexOf("favorite_list")!=-1&&(e.favorite="<a href='' ng-click='onfavorite(result)'><span class='glyphicon glyphicon-plus' aria-hidden='true' style='color: #ff7224;text-shadow: 1px 1px 1px #ccc;font-size: 1.5em;right: 10px;'></span></a>"),t.permissions.indexOf("edit_phone")!=-1&&(e.edit_buttom="<button type='button' class='btn btn-warning btn-sm' ng-click='onedit(result)' data-toggle='modal' data-target='#myModal'>ویرایش</button>"),t.permissions.indexOf("delete_phone")!=-1&&(e.delete_buttom="<button type='button' class='btn btn-danger btn-sm' ng-click='ondelete(result)'>حذف</button>"))},function(e){}),e.onsubmit=function(){e.delete_row=!0,n.stop("spinner"),"undefined"!=typeof e._data.search&&(n.spin("spinner"),t({method:"POST",url:"/",data:e._data}).then(function(t){n.stop("spinner"),e.query=t},function(e){n.stop("spinner"),toastr.error("اشکال داخلی سرور","خطا")}))},e.onedit=function(t){e._edit_form=t,e.edit_form.name=t.name,e.edit_form.departmenet=t.departmenet,e.edit_form.phone_number=t.phone_number,e.edit_form.inside_phone_number=t.inside_phone_number,e.edit_form.email=t.email,e.edit_form.room_number=t.room_number,e.edit_form.finder=t._id},e.sendedit=function(){t({method:"post",url:"/editnumber",data:e.edit_form}).then(function(){var t=e.query.indexOf(e._edit_form);e.query[t].name=e.edit_form.name,e.query[t].departmenet=e.edit_form.departmenet,e.query[t].phone_number=e.edit_form.phone_number,e.query[t].inside_phone_number=e.edit_form.inside_phone_number,e.query[t].email=e.edit_form.email,e.query[t].room_number=e.edit_form.room_number,document.getElementById("close").click(),toastr.info("تغییرات با موفقیت ثبت شد.","ویرایش")},function(e){toastr.error("اشکال داخلی سرور","خطا")})},e.ondelete=function(n){t({method:"POST",url:"/deletenumber",data:n}).then(function(){var t=e.query.indexOf(n);e.query.splice(t,1),toastr.warning("شماره تلفن با موفقیت حذف شد.","حذف")},function(){toastr.error("اشکال داخلی سرور","خطا")})},e.onfavorite=function(e){var n=e._id;t({url:"/favorite",method:"post",data:{id:n,type:"add"}}).then(function(e){e?toastr.info("شماره تلفن در لیست مورد علاقه ذخیره شد.","ثبت"):toastr.error("این شماره در لیست شما قرار دارد.","خطا")},function(){toastr.error("اشکال داخلی سرور","خطا")})}}]})}]);
var error=angular.module("error",["ngRoute"]);error.config(["$routeProvider",function(r){r.when("/error",{templateUrl:"views/error.html"})}]);
_add_phone=angular.module("add_phone",["ngRoute"]),_add_phone.config(["$routeProvider",function(e){e.when("/add_phone",{templateUrl:"views/add_phone.html",controller:["$scope","$http","$location",function(e,r,o){return e.permissions.indexOf("add_phone")==-1?(e.error.error_status=403,e.error.error_message="اجازه دسترسی به صفحه مورد نظر را ندارید!",o.path("/error")):(e.setActive("addphone"),e.HeaderName("اضافه کردن شماره تلفن"),e.body="fade-handel",e.header="fade-handel",e.user={},void(e.onsubmit=function(){r({method:"POST",url:"/add_phone",data:e.user}).then(function(r){"ok"==r?(toastr.success("اطلاعات کاربر با موفقیت ثبت شد.","ثبت"),e.user.name="",e.user.departmenet="",e.user.phone_number="",e.user.inside_phone_number="",e.user.email="",e.user.room_number=""):"duplicate_name"==r?toastr.error("نام کاربر در سیستم موجود است.","خطا"):"duplicate_number"==r?toastr.error("شماره تلفن در سیستم موجود است.","خطا"):"duplicate_inside_number"==r&&toastr.error("شماره داخلی در سیستم موجود است.","خطا")},function(e){403==e.status?toastr.error("دسترسی غیر مجاز","خطا"):toastr.error("اشکال داخلی سرور","خطا")})}))}]})}]);
_enroll=angular.module("enroll",["ngRoute"]),_enroll.config(["$routeProvider",function(e){e.when("/enroll",{templateUrl:"views/enroll.html",controller:["$scope","$http",function(e,r){e.setActive("enroll"),e.HeaderName("ثبت نام"),e.body="fade-handel",e.header="fade-handel",e.user={},e.onsubmit=function(){r({method:"POST",url:"/enroll",data:e.user}).then(function(r){"ok"==r?(toastr.success("اطلاعات کاربر با موفقیت ثبت شد.","ثبت"),e.user.name="",e.user.last_name="",e.user.username="",e.user.email="",e.user.password=""):"duplicate_username"==r?toastr.error("نام کاربر در سیستم موجود است.","خطا"):"duplicate_email"==r&&toastr.error("پست الکرونیکی در سیستم موجود است","خطا")},function(e){toastr.error("اشکال داخلی سرور","خطا")})}}]})}]);
_favorite=angular.module("favorite",["ngRoute"]),_favorite.config(["$routeProvider",function(e){e.when("/favorite",{templateUrl:"views/favorite.html",controller:["$scope","$http","$location",function(e,t,r){return e.permissions.indexOf("favorite_list")==-1?(e.error.error_status=403,e.error.error_message="اجازه دسترسی به صفحه مورد نظر را ندارید!",r.path("/error")):(e.setActive("favorite"),e.HeaderName("شماره های علاقمند"),e.body="fade-handel",e.header="fade-handel",t({url:"/favorite",method:"POST",data:{type:"get_data"}}).then(function(t){e.favoriteData=t},function(){toastr.error("اشکال داخلی سرور","خطا")}),void(e.on_delete=function(r){t({url:"/delfavorite",method:"POST",data:r}).then(function(){var t=e.favoriteData.indexOf(r);e.favoriteData.splice(t,1),toastr.warning("شماره تلفن از لیست مورد علاقه حذف شد.","حذف")},function(){toastr.error("اشکال داخلی سرور","خطا")})}))}]})}]);
var user_management=angular.module("user_management",["ngRoute"]);user_management.config(["$routeProvider",function(e){e.when("/user_management",{templateUrl:"views/user_management.html",controller:["$scope","$http","$location",function(e,r,t){return e.permissions.indexOf("edit_user")==-1&&e.permissions.indexOf("delete_user")==-1?(e.error.error_status=403,e.error.error_message="اجازه دسترسی به صفحه مورد نظر را ندارید!",t.path("/error")):(e.setActive("usermanagement"),e.HeaderName("مدیریت کاربران"),e.body="fade-handel",e.header="fade-handel",e.user_data={},e.edit_user={},e._edit_user={},r({url:"/user_management",method:"GET"}).then(function(r){e.user_data=r},function(e){toastr.error("اشکال داخلی سرور","خطا")}),e.on_change=function(r){e._edit_user=r,e.edit_user.first_name=r.first_name,e.edit_user.last_name=r.last_name,e.edit_user.username=r.username,e.edit_user.pervious_username=r.username,e.edit_user.email=r.email,e.edit_user.password="",e.edit_user.role=r.role.toString(),e.edit_user.repeat_password="",e.edit_user._id=r._id},e.password_check=function(){""==e.edit_user.password&&""==e.edit_user.repeat_password?e.password_validation="":e.edit_user.password==e.edit_user.repeat_password?e.password_validation="has-success":e.password_validation="has-error"},e.sendedit=function(){e.edit_user.password!=e.edit_user.repeat_password?toastr.error("رمز عبور و تکرار رمز عبور صحیح وارد نشده اند.","خطا"):r({url:"/edit_user",method:"POST",data:e.edit_user}).then(function(r){if("ok"==r){var t=e.user_data.indexOf(e._edit_user);e.user_data[t].first_name=e.edit_user.first_name,e.user_data[t].last_name=e.edit_user.last_name,e.user_data[t].email=e.edit_user.email,e.user_data[t].role=e.edit_user.role,e.user_data[t].username=e.edit_user.username,toastr.info("تغییرات با موفقیت ثبت شد.","ویرایش")}else"FError"==r?toastr.error("اطلاعات وارد شده قابل قبول نمی باشد.","خطا"):"UError"==r?toastr.error("نام کاربری در سیستم موجود است.","خطا"):"PError"==r&&toastr.error("رمز عبور مطابقت ندارد.","خطا")},function(e){return 403==e.status?toastr.error("دسترسی غیر مجاز","خطا"):void toastr.error("اشکال داخلی سرور","خطا")})},void(e.delete_user=function(t){r({url:"/deluser",method:"POST",data:t}).then(function(r){if("ok"==r){var s=e.user_data.indexOf(t);e.user_data.splice(s,1),toastr.warning("کاربر با موفقیت حذف شد.","حذف")}},function(e){return 403==e.status?toastr.error("دسترسی غیر مجاز","خطا"):void toastr.error("اشکال داخلی سرور","خطا")})}))}]})}]);
logs=angular.module("logs",["ngRoute"]),logs.config(["$routeProvider",function(e){e.when("/logs",{templateUrl:"views/logs.html",controller:["$scope","$http","$location",function(e,o,r){return e.permissions.indexOf("system_logs")==-1?(e.error.error_status=403,e.error.error_message="اجازه دسترسی به صفحه مورد نظر را ندارید!",r.path("/error")):(e.setActive("logs"),e.HeaderName("لاگ های سرور"),e.body="fade-handel",e.header="fade-handel",void(e.logs=""))}]})}]);